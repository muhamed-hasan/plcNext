# قارئ بيانات PLC S7-1200 باستخدام Next.js

هذا المشروع يقرأ البيانات من PLC S7-1200 عبر بروتوكول S7comm باستخدام Next.js و nodes7، ويعرضها في لوحة تحكم حديثة مع رسوم بيانية تفاعلية.

## المميزات

- استخدام Next.js API Routes للاتصال بـ PLC
- واجهة مستخدم حديثة باستخدام React و Tailwind CSS مع أيقونات
- رسوم بيانية متقدمة لعرض البيانات التاريخية
- تخزين وعرض بيانات PLC من قاعدة البيانات
- تحديث البيانات كل 10 ثوانٍ
- دعم اللغة العربية بشكل كامل (RTL)
- تنسيق جميل للبيانات (درجات الحرارة، الرطوبة، سرعة الهواء)
- عرض البيانات التاريخية لفترات زمنية مختلفة (24 ساعة، 7 أيام، 30 يوم)

## البدء

### المتطلبات

1. Node.js 16 أو أحدث
2. PLC S7-1200 متصل بشبكة يمكن الوصول إليها
3. قاعدة بيانات لتخزين البيانات التاريخية (اختياري)

### التثبيت

1. تثبيت المكتبات المطلوبة:

```bash
npm install
```

### التكوين

#### إعدادات PLC

يمكنك تعديل إعدادات الاتصال بـ PLC في ملف `app/api/plc/route.js`:

```javascript
const plcConfig = {
  ip: '192.168.0.1',  // قم بتغييره إلى عنوان IP الخاص بـ PLC
  rack: 0,
  slot: 1,
  port: 102
};
```

#### إعدادات قاعدة البيانات

يمكنك تكوين اتصال قاعدة البيانات في ملف `app/lib/db.js`. الملف يحتوي على أمثلة لكيفية تكوين:

- MySQL
- MongoDB

قم بإلغاء التعليق على الكود المناسب واستبدال معلومات الاتصال بقاعدة البيانات الخاصة بك.

## تشغيل التطبيق

لتشغيل التطبيق في وضع التطوير:

```bash
npm run dev
```

لبناء التطبيق للإنتاج:

```bash
npm run build
```

لتشغيل التطبيق في وضع الإنتاج:

```bash
npm run start
```

## استخدام التطبيق

افتح متصفحك وانتقل إلى `http://localhost:3000/` لعرض واجهة المستخدم.

### الميزات الرئيسية

1. **لوحة القيم الحالية**:
   - عرض القيم الحالية التي تمت قراءتها من PLC
   - أيقونات توضيحية لأنواع البيانات المختلفة
   - ترميز لوني لتسهيل قراءة البيانات

2. **لوحة البيانات التاريخية**:
   - رسوم بيانية تفاعلية للبيانات التاريخية
   - إمكانية اختيار النطاق الزمني (24 ساعة، 7 أيام، 30 يوم)
   - رسوم بيانية منفصلة لدرجات الحرارة والرطوبة وسرعة الهواء

3. **تحديث البيانات**:
   - تحديث تلقائي كل 10 ثوانٍ
   - زر تحديث يدوي
   - عرض وقت آخر تحديث

## تخصيص قاعدة البيانات

التطبيق مُعد للاتصال بأي قاعدة بيانات تفضلها. لتكوين قاعدة البيانات الخاصة بك:

1. قم بتحرير ملف `app/lib/db.js`
2. قم بإلغاء التعليق على كود قاعدة البيانات المناسبة (MySQL، MongoDB، إلخ)
3. قم بتكوين معلومات الاتصال الخاصة بك

يتضمن الملف دالتين رئيسيتين:

- `storePlcData`: لتخزين بيانات PLC في قاعدة البيانات
- `getHistoricalData`: لاسترجاع البيانات التاريخية من قاعدة البيانات

## استكشاف الأخطاء وإصلاحها

إذا واجهت مشاكل في الاتصال بـ PLC:

1. تأكد من أن PLC متصل بالشبكة
2. تحقق من إعدادات IP و Rack و Slot
3. تأكد من أن جدار الحماية لا يمنع الاتصال بالمنفذ 102
4. تحقق من تكوين DB في PLC
5. تأكد من أن مكتبة nodes7 تم تثبيتها بشكل صحيح

## مزايا استخدام Node.js بدلاً من Python

1. **بنية التطبيق الموحدة**: استخدام JavaScript فقط في جميع أجزاء التطبيق.
2. **بدون عمليات منفصلة**: التطبيق بأكمله يعمل في عملية واحدة، مما يجعل التشغيل أسهل.
3. **API مباشرة**: البيانات تُقرأ مباشرة من PLC إلى التطبيق دون الحاجة إلى ملفات وسيطة.
4. **قابلية للتوسع**: سهولة إضافة ميزات جديدة باستخدام مكتبات JavaScript.
5. **أداء أفضل**: استجابة أسرع واستهلاك أقل للموارد.
6. **رسوم بيانية متقدمة**: استخدام Chart.js للرسوم البيانية التفاعلية.
7. **تكامل سلس مع قواعد البيانات**: دعم متكامل للعديد من قواعد البيانات. 